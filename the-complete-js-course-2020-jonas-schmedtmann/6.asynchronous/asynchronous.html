<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>
<body>
  <h1>Asynchronous JavaScript</h1>
  <script>
    // produce
    const getIDs = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve([523, 883, 432, 974]);
      }, 1500);
    });

    // produce
    const getRecipe = recID => {
      return new Promise((resolve, reject) => {
        setTimeout(ID => {
          const recipe = {title: 'Fresh tomato pasta', publisher: 'Jonas'};
            resolve(`${ID}: ${recipe.title},${recipe.publisher}`);
          }, 1500, recID);
      })
    };

    const getRelated = publisher => {
      return new Promise ((resolve, reject) => {
        setTimeout(pub => {
          const recipe = {title: 'pizza', publisher: 'Jonas'};
            resolve(`${recipe.title},${recipe.publisher}`);
        }, 1000, publisher)
      })
    }
// consume
// chaining
    getIDs
    .then(IDs => {
      console.log('then',IDs);
      // this   getRecipe(IDs[2])  will return a promise, that if resolve gives us the id and the recipe name
      return getRecipe(IDs[2]) 
    })
    .then(recipe => {
      console.log('recipe',recipe);
      return getRelated(recipe.publisher)
    })
    .then(recipe => {
      console.log(recipe);
    })
    .catch(error => {
      console.log('error!',error);
    });

  </script>
</body>
</html>